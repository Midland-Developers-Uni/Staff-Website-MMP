name: Mirror Organization Repo to Personal Repo

on:
  push:
    branches:
      - main
    paths:
      - 'path/to/files/**'  # If you want to target specific files

jobs:
  mirror:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code from the org repo
        uses: actions/checkout@v4
        with:
          ref: main

      - name: Set up Git
        run: |
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"

      - name: Add personal repo remote
        run: |
          # Mask the PAT token to prevent leaks in logs
          echo "::add-mask::${{ secrets.PERSONAL_PAT }}"
          
          # Set the URL for the personal repo using the token
          git remote set-url origin "https://x-access-token:${{ secrets.PERSONAL_PAT }}@github.com/JMJones716/Staff-Website-MMP.git"
          
      - name: Debug Check remote URL
        run: |
          git remote -v

      - name: Push to personal repo
        run: |
          git push origin main
